![logo](./assets/logo.png)
# WebSocket Service
Микросервис, отвечающий за управление соединений WebSocket

## Содержимое
* [Сборка](#сборка)
* [Деплой](#деплой)
* [Настройка](#настройка)
  * [Переменные окружения](#переменные-окружения)
* [Описание эндпоинтов](#эндпоинты)

# Сборка
Микросервис написан на Rust, так что чтобы\
собрать его вам необходимо лишь установить ``cargo`` на ваш ПК,
и прописать следующую команду

```bash
cargo build --release
```

После успешной сборки вы сможете найти артефакт по этому пути ``./target/release/wss_service``.

# Деплой
Команды для деплоя уже есть в нашем [Puff-файле](./puff.yml).

[Узнать подробнее что такое Puff-файл](https://github.com/smokingplaya/puff)

```bash
# Собирает сервис и пушит его в регистр под тегом latest
puff deploy
```

# Настройка

## Переменные окружения
``DATABASE_URL: string`` - URL для подключения к PostgreSQL.

# Эндпоинты

## GET /{id}

### Описание
Изменяет подключение с HTTP(s) до WebSocket(Secure)

### Аутентификация
Требует JWT пользователя в хедере ``Authorization`` на проде,\
Gateway должен вытащить ``ID пользователя`` из JWT.

### Параметры
- **id** (string, обязателен): Айди пользователя

## POST /send/{id}

### Описание
Отправляет ивент на все активные WebSocket соединения\
указанного пользователя.

### Аутентификация
``Внутренний эндпоинт`` - это значит что эндпоинт\
должен быть доступен только в рамках API Gateway.